<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flatmate Style Quiz - UniMates</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="mobile.css">
  <link rel="stylesheet" href="quiz-desktop.css">
</head>
<body class="quiz-page-body">
  <div class="bg-animation"></div>
  
  <div class="orb orb1"></div>
  <div class="orb orb2"></div>
  <div class="orb orb3"></div>

  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="logo">
        <img src="logo.png" alt="UniMates Logo">
        <span class="logo-text">UniMates</span>
      </a>
      <a href="quiz.html" class="quiz-header-ad">
        <span class="quiz-header-ad-icon">âœ¨</span>
        <span class="quiz-header-ad-text">Take the Personality Quiz!</span>
      </a>
      <button class="hamburger" onclick="toggleMenu(this)" aria-label="Toggle navigation menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="how-it-works.html">How it works</a></li>
        <li><a href="about.html">About us</a></li>
      </ul>
    </div>
    <div class="mobile-overlay" onclick="closeMenu()"></div>
  </nav>

  <header class="quiz-header">
    <h1 class="section-title">What's Your Flatmate Style?</h1>
    <p class="section-subtitle">
      Answer a few questions to discover your living preferences and find compatible flatmates.
    </p>
    <div class="quiz-progress">
      <div class="progress-bar" id="progress"></div>
    </div>
  </header>

  <main class="quiz-container">
    <div class="question-card" id="questionCard">
      <div class="question-number">Question <span id="currentQuestion">1</span> of 10</div>
      <div class="question-text" id="questionText"></div>
      <div class="options-grid" id="options"></div>
      <div class="quiz-navigation">
        <button class="nav-button" id="prevBtn" style="display: none;">Previous</button>
        <button class="nav-button next" id="nextBtn">Next</button>
      </div>
    </div>

    <div class="results-section" id="resultsSection">
      <h2 class="section-title">Your Results Are Ready!</h2>
      
      <div class="results-preview">
        <div class="results-teaser" id="resultsTeaser"></div>
        <div class="results-overlay">
          <div class="results-lock-icon">ðŸ”’</div>
          <h3 class="results-lock-title">Unlock Your Full Results</h3>
          <p class="results-lock-description">
            Join our waitlist to see your complete personality profile and start connecting with compatible flatmates!
          </p>
          <form id="waitlistForm" class="waitlist-form">
            <input type="email" id="email" placeholder="Enter your email address" required />
            <label class="waitlist-checkbox-label" style="display: flex; align-items: center; gap: 0.4rem; font-size: 0.88rem; color: var(--text-dim); margin-top: 0.2rem; font-weight: 400;">
              <input type="checkbox" id="waitlist-accept" required style="accent-color: var(--accent); width: 1rem; height: 1rem; border-radius: 5px; margin-right: 0.4rem;" />
              I agree to receive updates, beta invitations, and occasional emails from UniMates. I understand I can unsubscribe at any time.
            </label>
            <button type="submit" class="cta-button">Join Waitlist</button>
          </form>
          <div id="successMessage" class="success-message" style="display:none;">
            ðŸŽ‰ You're on the list! Check out your complete results below.
          </div>
        </div>
      </div>
      
      <div class="full-results" id="fullResults"></div>
    </div>
  </main>
  <footer class="site-footer">
    <div class="footer-content">
      <div class="footer-cube-container">
        <div class="cube" tabindex="0">
          <div class="cube-face cube-face-front"><img src="logo.svg" alt="Logo" width="60" height="60"></div>
          <div class="cube-face cube-face-back"><img src="logo.svg" alt="Logo" width="60" height="60"></div>
          <div class="cube-face cube-face-right"><img src="logo.svg" alt="Logo" width="60" height="60"></div>
          <div class="cube-face cube-face-left"><img src="logo.svg" alt="Logo" width="60" height="60"></div>
          <div class="cube-face cube-face-top"><img src="logo.svg" alt="Logo" width="60" height="60"></div>
          <div class="cube-face cube-face-bottom"><img src="logo.svg" alt="Logo" width="60" height="60"></div>
        </div>
      </div>
      <div class="footer-social">
        <a href="https://instagram.com/unimates.info" target="_blank" aria-label="Instagram" class="footer-social-link"><i class="fab fa-instagram"></i></a>
        <a href="https://tiktok.com/@unimatesapp" target="_blank" aria-label="TikTok" class="footer-social-link"><i class="fab fa-tiktok"></i></a>
        <a href="https://www.youtube.com/channel/UCMKHVISj443ioGYAZYRUrTQ" target="_blank" aria-label="YouTube" class="footer-social-link"><i class="fab fa-youtube"></i></a>
        <a href="https://www.linkedin.com/company/unimatesapp" target="_blank" aria-label="LinkedIn" class="footer-social-link"><i class="fab fa-linkedin"></i></a>
        <a href="https://mail.google.com/mail/?view=cm&fs=1&to=info@unimates.net&su=Regarding Your Inquiry&body=Dear Unimates Team,"aria-label="Email" class="footer-social-link"><i class="fas fa-envelope"></i></a></div>
      </div>
    </div>
    <div class="footer-copy">&copy; 2025 UniMates. All rights reserved.</div>
  </footer>

  <canvas id="confetti-canvas"></canvas>

  <script>
    const questions = [
      {
        text: "How do you typically spend your evenings at home?",
        options: [
          { icon: "ðŸŽ®", text: "Gaming or watching movies", value: "entertainment" },
          { icon: "ðŸ“š", text: "Studying or reading", value: "studious" },
          { icon: "ðŸŽ¨", text: "Creative hobbies", value: "creative" },
          { icon: "ðŸ‘¥", text: "Socializing with friends", value: "social" }
        ]
      },
      {
        text: "What's your ideal noise level at home?",
        options: [
          { icon: "ðŸ¤«", text: "Complete silence", value: "quiet" },
          { icon: "ðŸ“±", text: "Background noise is fine", value: "moderate" },
          { icon: "ðŸŽµ", text: "Music and conversation", value: "lively" },
          { icon: "ðŸŽ‰", text: "The livelier, the better", value: "vibrant" }
        ]
      },
      {
        text: "How do you prefer to handle household chores?",
        options: [
          { icon: "ðŸ“‹", text: "Strict cleaning schedule", value: "organized" },
          { icon: "ðŸ¤", text: "Share tasks as needed", value: "flexible" },
          { icon: "âœ¨", text: "Clean when it gets messy", value: "relaxed" },
          { icon: "ðŸ’°", text: "Hire cleaning service", value: "outsource" }
        ]
      },
      {
        text: "What's your typical sleep schedule?",
        options: [
          { icon: "ðŸŒ…", text: "Early bird (Before 6 AM)", value: "early" },
          { icon: "â˜€ï¸", text: "Morning person (6-8 AM)", value: "morning" },
          { icon: "ðŸŒ™", text: "Night owl (After midnight)", value: "night" },
          { icon: "â­", text: "Varies day to day", value: "flexible" }
        ]
      },
      {
        text: "How often do you cook at home?",
        options: [
          { icon: "ðŸ‘¨â€ðŸ³", text: "Love cooking daily", value: "chef" },
          { icon: "ðŸ¥—", text: "Cook simple meals", value: "casual" },
          { icon: "ðŸ”„", text: "Meal prep weekly", value: "prep" },
          { icon: "ðŸš¶", text: "Prefer takeout/eating out", value: "takeout" }
        ]
      },
      {
        text: "How do you feel about sharing items?",
        options: [
          { icon: "ðŸ¤²", text: "Happy to share everything", value: "communal" },
          { icon: "ðŸ”„", text: "Share with clear boundaries", value: "selective" },
          { icon: "ðŸ”’", text: "Prefer keeping things separate", value: "private" },
          { icon: "ðŸ’­", text: "Depends on the item", value: "flexible" }
        ]
      },
      {
        text: "What's your approach to guests?",
        options: [
          { icon: "ðŸŽ‰", text: "Love hosting often", value: "social" },
          { icon: "ðŸ‘¥", text: "Occasional small gatherings", value: "moderate" },
          { icon: "ðŸ¤", text: "Only close friends", value: "selective" },
          { icon: "ðŸ ", text: "Prefer private space", value: "private" }
        ]
      },
      {
        text: "How do you handle conflicts?",
        options: [
          { icon: "ðŸ’¬", text: "Address immediately", value: "direct" },
          { icon: "ðŸ¤", text: "Find compromise", value: "diplomatic" },
          { icon: "ðŸ“", text: "Write it down first", value: "thoughtful" },
          { icon: "ðŸ•Šï¸", text: "Avoid confrontation", value: "passive" }
        ]
      },
      {
        text: "What's your ideal weekend activity?",
        options: [
          { icon: "ðŸƒ", text: "Active and outdoors", value: "active" },
          { icon: "ðŸŽ®", text: "Relaxing at home", value: "homebody" },
          { icon: "ðŸŽ¨", text: "Creative projects", value: "creative" },
          { icon: "ðŸŽ‰", text: "Social activities", value: "social" }
        ]
      },
      {
        text: "How do you manage shared expenses?",
        options: [
          { icon: "ðŸ“Š", text: "Detailed spreadsheets", value: "organized" },
          { icon: "ðŸ“±", text: "Using split apps", value: "tech" },
          { icon: "ðŸ’°", text: "Keep rough tallies", value: "casual" },
          { icon: "ðŸ¤", text: "Pay as needed", value: "flexible" }
        ]
      }
    ];

    const personalityTypes = {
      socialButterfly: {
        title: "The Social Butterfly",
        icon: "ðŸ¦‹",
        description: "You thrive in a lively home environment and love bringing people together. Your ideal living space is a social hub where friends gather and memories are made.",
        traits: [
          { icon: "ðŸŽ‰", label: "Social Energy", value: "High" },
          { icon: "ðŸ¤", label: "Sharing Style", value: "Open & Generous" },
          { icon: "ðŸ ", label: "Home Vibe", value: "Lively & Welcoming" },
          { icon: "â­", label: "Best Quality", value: "Community Builder" }
        ],
        compatibleWith: ["Creative Spirit", "Free Spirit", "Balanced Mediator"]
      },
      focusedScholar: {
        title: "The Focused Scholar",
        icon: "ðŸ“š",
        description: "You value structure, quiet time, and an organized living space. Your ideal home is a peaceful sanctuary that supports your academic and personal goals.",
        traits: [
          { icon: "ðŸ¤«", label: "Noise Preference", value: "Minimal" },
          { icon: "ðŸ“‹", label: "Organization", value: "Highly Structured" },
          { icon: "ðŸ ", label: "Home Vibe", value: "Calm & Focused" },
          { icon: "â­", label: "Best Quality", value: "Self-Disciplined" }
        ],
        compatibleWith: ["Mindful Zen", "Tech Enthusiast", "Balanced Mediator"]
      },
      creativeSpirit: {
        title: "The Creative Spirit",
        icon: "ðŸŽ¨",
        description: "You bring artistic flair and spontaneity to your living space. Your ideal home is a canvas for expression and inspiration.",
        traits: [
          { icon: "ðŸŽ¨", label: "Expression", value: "Highly Creative" },
          { icon: "ðŸ ", label: "Home Vibe", value: "Artistic & Inspiring" },
          { icon: "âŒš", label: "Schedule", value: "Flexible" },
          { icon: "â­", label: "Best Quality", value: "Imaginative" }
        ],
        compatibleWith: ["Social Butterfly", "Free Spirit", "Tech Enthusiast"]
      },
      mindfulZen: {
        title: "The Mindful Zen",
        icon: "ðŸ§˜",
        description: "You prioritize a clean, tranquil, and harmonious environment. Your ideal home is a peaceful retreat from the hustle and bustle of daily life.",
        traits: [
          { icon: "ðŸŒ¿", label: "Atmosphere", value: "Calm & Tidy" },
          { icon: "ðŸ¤", label: "Conflict Style", value: "Diplomatic" },
          { icon: "ðŸ ", label: "Home Vibe", value: "Peaceful & Harmonious" },
          { icon: "â­", label: "Best Quality", value: "Considerate" }
        ],
        compatibleWith: ["Focused Scholar", "Balanced Mediator", "Tech Enthusiast"]
      },
      techEnthusiast: {
        title: "The Tech Enthusiast",
        icon: "ðŸš€",
        description: "You're passionate about the latest gadgets and smart home technology. Your ideal home is an efficient, modern space optimized with technology.",
        traits: [
          { icon: "ðŸ“±", label: "Gadgets", value: "Latest & Greatest" },
          { icon: "ðŸ’°", label: "Expenses", value: "Managed with Apps" },
          { icon: "ðŸ ", label: "Home Vibe", value: "Modern & Efficient" },
          { icon: "â­", label: "Best Quality", value: "Innovative" }
        ],
        compatibleWith: ["Focused Scholar", "Creative Spirit", "Free Spirit"]
      },
      freeSpirit: {
        title: "The Free Spirit",
        icon: "ðŸ•Šï¸",
        description: "You're adaptable, easygoing, and prefer to go with the flow. Your ideal living situation is relaxed and flexible, without rigid rules.",
        traits: [
          { icon: "âœ¨", label: "Cleanliness", value: "Relaxed" },
          { icon: "âŒš", label: "Schedule", value: "Highly Flexible" },
          { icon: "ðŸ ", label: "Home Vibe", value: "Easygoing & Adaptable" },
          { icon: "â­", label: "Best Quality", value: "Spontaneous" }
        ],
        compatibleWith: ["Social Butterfly", "Creative Spirit", "Tech Enthusiast"]
      },
      balancedMediator: {
        title: "The Balanced Mediator",
        icon: "âš–ï¸",
        description: "You're a master of compromise and value harmony above all. Your ideal home is a fair, cooperative space where everyone feels heard.",
        traits: [
          { icon: "ðŸ¤", label: "Approach", value: "Diplomatic & Fair" },
          { icon: "ðŸ”„", label: "Sharing", value: "With Boundaries" },
          { icon: "ðŸ ", label: "Home Vibe", value: "Cooperative & Harmonious" },
          { icon: "â­", label: "Best Quality", value: "Fair-minded" }
        ],
        compatibleWith: ["Social Butterfly", "Focused Scholar", "Mindful Zen"]
      }
    };
    
    // Quiz state and elements
    const progressBar = document.getElementById('progress');
    const questionText = document.getElementById('questionText');
    const optionsGrid = document.getElementById('options');
    const nextBtn = document.getElementById('nextBtn');
    const prevBtn = document.getElementById('prevBtn');
    const questionCard = document.getElementById('questionCard');
    const resultsSection = document.getElementById('resultsSection');
    const fullResultsContainer = document.getElementById('fullResults');
    const resultsTeaser = document.getElementById('resultsTeaser');

    let currentQuestionIndex = 0;
    let userAnswers = {};

    function updateQuestion() {
      optionsGrid.classList.remove('has-selection');
      const question = questions[currentQuestionIndex];
      questionText.textContent = question.text;
      optionsGrid.innerHTML = '';
      
      question.options.forEach(option => {
        const optionElement = document.createElement('div');
        optionElement.className = 'answer-option';
        optionElement.dataset.value = option.value;
        optionElement.innerHTML = `
          <div class="option-icon">${option.icon}</div>
          <div class="option-text">${option.text}</div>
        `;
        optionsGrid.appendChild(optionElement);
      });

      const selectedValue = userAnswers[currentQuestionIndex];
      if (selectedValue) {
        const selectedOption = optionsGrid.querySelector(`.answer-option[data-value="${selectedValue}"]`);
        if (selectedOption) {
          selectedOption.classList.add('selected');
          optionsGrid.classList.add('has-selection');
          const indicator = document.createElement('span');
          indicator.className = 'selection-indicator';
          indicator.innerHTML = `<i class="fas fa-check"></i>`;
          selectedOption.appendChild(indicator);
        }
      }

      updateProgress();
      document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
      
      prevBtn.style.display = currentQuestionIndex > 0 ? 'inline-block' : 'none';
      if(currentQuestionIndex === questions.length - 1) {
        nextBtn.textContent = 'See Results';
      } else {
        nextBtn.textContent = 'Next';
      }
      
      const isAnswered = userAnswers[currentQuestionIndex] !== undefined;
      nextBtn.disabled = !isAnswered;
      if(isAnswered) {
          nextBtn.classList.remove('disabled');
      } else {
          nextBtn.classList.add('disabled');
      }
    }

    function updateProgress() {
      const progressPercentage = ((currentQuestionIndex + 1) / questions.length) * 100;
      progressBar.style.width = `${progressPercentage}%`;
    }

    optionsGrid.addEventListener('click', (e) => {
      const option = e.target.closest('.answer-option');
      if (!option) return;

      const currentOptions = optionsGrid.querySelectorAll('.answer-option');
      currentOptions.forEach(opt => {
        opt.classList.remove('selected');
        const indicator = opt.querySelector('.selection-indicator');
        if (indicator) {
          indicator.remove();
        }
      });
      
      option.classList.add('selected');
      const indicator = document.createElement('span');
      indicator.className = 'selection-indicator';
      indicator.innerHTML = `<i class="fas fa-check"></i>`;
      option.appendChild(indicator);

      optionsGrid.classList.add('has-selection');
      
      const selectedValue = option.dataset.value;
      userAnswers[currentQuestionIndex] = selectedValue;
      nextBtn.disabled = false;
      nextBtn.classList.remove('disabled');
    });

    nextBtn.addEventListener('click', () => {
      if (userAnswers[currentQuestionIndex] === undefined) {
        // Optionally, show a message to select an answer
        return;
      }
      if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        updateQuestion();
      } else {
        showResults();
      }
    });

    prevBtn.addEventListener('click', () => {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        updateQuestion();
      }
    });

    function calculatePersonalityType(answers) {
      const counts = answers.reduce((acc, value) => {
        acc[value] = (acc[value] || 0) + 1;
        return acc;
      }, {});

      let primaryTrait = 'balancedMediator';
      let maxCount = 0;

      const traitMapping = {
        social: 'socialButterfly',
        studious: 'focusedScholar', quiet: 'focusedScholar', organized: 'focusedScholar',
        creative: 'creativeSpirit',
        relaxed: 'freeSpirit', flexible: 'freeSpirit',
        direct: 'balancedMediator', diplomatic: 'balancedMediator',
        tech: 'techEnthusiast',
        communal: 'socialButterfly',
        private: 'mindfulZen',
      };
      
      for(const answer in counts) {
          const count = counts[answer];
          const trait = traitMapping[answer];
          if(trait && count > maxCount) {
              maxCount = count;
              primaryTrait = trait;
          }
      }

      const socialCount = (counts['social'] || 0) + (counts['vibrant'] || 0);
      if (socialCount >= 2) primaryTrait = 'socialButterfly';
      
      const quietCount = (counts['quiet'] || 0) + (counts['studious'] || 0);
      if(quietCount >=2) primaryTrait = 'focusedScholar';

      return primaryTrait;
    }

    function showResults() {
      const personalityType = calculatePersonalityType(Object.values(userAnswers));
      const result = personalityTypes[personalityType];
      
      questionCard.style.display = 'none';
      resultsSection.style.display = 'block';

      // Populate Teaser
      resultsTeaser.innerHTML = `
        <div class="teaser-icon">${result.icon}</div>
        <h3 class="teaser-title">You're a ${result.title}!</h3>
        <p class="teaser-description">${result.description}</p>
      `;

      // Populate Full Results (initially hidden)
      fullResultsContainer.innerHTML = `
        <h3 class="full-results-title">Your Complete ${result.title} Profile</h3>
        <div class="full-results-grid">
            ${result.traits.map(trait => `
              <div class="result-trait-card">
                  <div class="trait-icon">${trait.icon}</div>
                  <div class="trait-label">${trait.label}</div>
                  <div class="trait-value">${trait.value}</div>
              </div>
            `).join('')}
        </div>
        <div class="compatible-section">
            <h4 class="compatible-title">You're most compatible with:</h4>
            <div class="compatible-grid">
                ${result.compatibleWith.map(compType => {
                  const compatibleResult = personalityTypes[compType];
                  return `
                    <div class="compatible-card">
                        <div class="compatible-icon">${compatibleResult.icon}</div>
                        <div class="compatible-name">${compatibleResult.title}</div>
                    </div>
                  `
                }).join('')}
            </div>
        </div>
      `;
    }

    // Waitlist Form Handling
    const waitlistForm = document.getElementById('waitlistForm');
    const emailInput = document.getElementById('email');
    const successMessage = document.getElementById('successMessage');
    const resultsOverlay = document.querySelector('.results-overlay');
    const checkbox = document.getElementById('waitlist-accept');
    const submitButton = waitlistForm.querySelector('.cta-button');

    function validateForm() {
      const emailValid = emailInput.value.trim() !== '';
      const checkboxValid = checkbox.checked;
      const isValid = emailValid && checkboxValid;
      
      submitButton.disabled = !isValid;
      if (isValid) {
        submitButton.classList.remove('disabled');
      } else {
        submitButton.classList.add('disabled');
      }
    }

    emailInput.addEventListener('input', validateForm);
    checkbox.addEventListener('change', validateForm);

    // Initial validation
    validateForm();

    waitlistForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = emailInput.value;
      
      // Basic validation
      if(!email) return;

      try {
        const response = await fetch('http://127.0.0.1:8000/join-waitlist', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email: email, answers: userAnswers })
        });
        
        if (response.ok) {
          successMessage.style.display = 'block';
          waitlistForm.style.display = 'none';
          document.querySelector('.results-lock-icon').style.display = 'none';
          document.querySelector('.results-lock-title').style.display = 'none';
          document.querySelector('.results-lock-description').style.display = 'none';
          
          resultsOverlay.style.backdropFilter = 'none';
          resultsOverlay.style.background = 'none';
          
          // Confetti
          const canvas = document.getElementById('confetti-canvas');
          const confetti = window.confetti;
          canvas.style.display = 'block';
          confetti({
            particleCount: 150,
            spread: 80,
            origin: { y: 0.6 }
          });

          // Reveal full results
          setTimeout(() => {
              fullResultsContainer.style.maxHeight = fullResultsContainer.scrollHeight + 'px';
              fullResultsContainer.style.opacity = '1';
          }, 200);


        } else {
          const errorData = await response.json();
          alert(`Error: ${errorData.detail || 'Could not join waitlist.'}`);
        }
      } catch (error) {
        console.error('Submission error:', error);
        alert('Connection error. Please try again later.');
      }
    });
    
    // Initial call
    updateQuestion();

    // Footer cube continuous animation
    (function() {
      const cube = document.querySelector('.footer-cube-container .cube');
      if (!cube) return;
      
      let angleY = 30;
      let angleX = -20;
      let animationFrame;
      let running = true;

      function animate() {
        if (running) {
          angleY += 0.6; // speed of rotation
          if (angleY > 360) angleY -= 360;
          cube.style.transform = `rotateX(${angleX}deg) rotateY(${angleY}deg)`;
        }
        animationFrame = requestAnimationFrame(animate);
      }

      cube.addEventListener('mouseenter', () => { running = false; });
      cube.addEventListener('mouseleave', () => { running = true; });
      cube.addEventListener('focus', () => { running = false; });
      cube.addEventListener('blur', () => { running = true; });

      animate();
    })();

    // Menu functionality
    function toggleMenu(btn) {
      const nav = document.querySelector('.navbar');
      const navLinks = document.querySelector('.nav-links');
      const overlay = document.querySelector('.mobile-overlay');
      const body = document.body;
      const quizButton = document.querySelector('.quiz-header-ad');
      
      nav.classList.toggle('active');
      navLinks.classList.toggle('show');
      overlay.classList.toggle('show');
      btn.classList.toggle('active');

      if (quizButton) {
        quizButton.classList.toggle('hidden');
      }
      
      if (navLinks.classList.contains('show')) {
        body.style.overflow = 'hidden';
      } else {
        body.style.overflow = '';
      }
    }

    function closeMenu() {
      const nav = document.querySelector('.navbar');
      const navLinks = document.querySelector('.nav-links');
      const overlay = document.querySelector('.mobile-overlay');
      const hamburger = document.querySelector('.hamburger');
      const body = document.body;
      const quizButton = document.querySelector('.quiz-header-ad');
      
      nav.classList.remove('active');
      navLinks.classList.remove('show');
      overlay.classList.remove('show');
      hamburger.classList.remove('active');

      if (quizButton) {
        quizButton.classList.remove('hidden');
      }
      body.style.overflow = '';
    }

    // General event listeners
    document.addEventListener('DOMContentLoaded', () => {
      window.addEventListener('resize', () => {
        if (window.innerWidth > 768) {
          closeMenu();
        }
      });

      document.querySelectorAll('.nav-links a').forEach(link => {
        link.addEventListener('click', closeMenu);
      });
    });
    
    // Confetti from CDN
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "m9rfm9i445");
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js';
    document.body.appendChild(script);

  </script>
  <script src="view-switcher.js"></script>
</body>
</html>